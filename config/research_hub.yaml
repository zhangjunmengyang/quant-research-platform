# =============================================================================
# Research Hub 配置
# =============================================================================
# 研报知识库 RAG 系统配置
# 定位: 数据存储管理平台（标量、向量、未来 Graph）
# =============================================================================

# 默认配置
default:
  pipeline: default
  upload_dir: private/research
  max_file_size_mb: 100

# 流水线配置
pipelines:
  # 默认流水线
  default:
    name: default
    description: "默认 RAG 流水线"

    # 解析器
    parser:
      type: basic  # 使用 PyMuPDF

    # 切块器
    chunker:
      type: recursive
      chunk_size: 512
      chunk_overlap: 50

    # 嵌入器 (OpenAI API)
    embedder:
      type: openai
      model: text-embedding-3-small
      dimensions: 512

    # 向量存储 (PostgreSQL + pgvector)
    vector_store:
      type: pgvector
      collection_name: research_chunks
      index_type: hnsw

    # 检索器
    retriever:
      type: dense
      top_k: 20

    # 流水线选项
    enable_query_rewrite: false
    enable_rerank: false
    max_context_length: 8000

  # 高质量流水线 (启用查询重写和重排)
  quality:
    name: quality
    description: "高质量流水线，启用查询重写和结果重排"

    parser:
      type: basic

    chunker:
      type: recursive
      chunk_size: 768
      chunk_overlap: 100

    embedder:
      type: openai
      model: text-embedding-3-small
      dimensions: 512

    vector_store:
      type: pgvector
      collection_name: research_chunks
      index_type: hnsw

    retriever:
      type: dense
      top_k: 30

    enable_query_rewrite: true
    enable_rerank: true
    max_context_length: 16000
